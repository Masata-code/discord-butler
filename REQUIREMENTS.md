# Discord Butler 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
Discord Butler（ディスコード・バトラー）

### 1.2 概要
DiscordのDMを通じて、ユーザーの作業に適したAIツールを自動的にリサーチし、具体的な使用方法まで提案する自動化システム。AI初心者でも簡単に最適なAIツールを発見・活用できることを目的とする。

### 1.3 技術スタック
- **自動化プラットフォーム**: n8n
- **メッセージング**: Discord Bot API
- **AI/LLM**: OpenAI API / Claude API
- **データストレージ**: PostgreSQL または SQLite（ユーザー履歴保存用）

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 Discord DM受信・応答機能
- DiscordのDMを受信し、内容を解析
- 自動的に返信を生成・送信
- 会話履歴の保持（セッション管理）

#### 2.1.2 作業内容解析機能
- ユーザーのメッセージから作業内容を理解
- 作業の目的、分野、難易度を自動判定
- 曖昧な要求に対する質問による明確化

#### 2.1.3 AIツールリサーチ機能
- 作業内容に基づいた最適なAIツールの検索
- 以下の観点でツールを評価：
  - 作業との適合性
  - 使いやすさ（AI初心者向け）
  - 料金体系
  - 日本語対応
  - 機能の充実度

#### 2.1.4 使用方法提案機能
- 選定したAIツールの具体的な使用手順を生成
- ステップバイステップのガイド作成
- 実際の使用例やプロンプト例の提示
- 注意点やコツの共有

### 2.2 追加機能

#### 2.2.1 ユーザープロファイル管理
- ユーザーのスキルレベル記録
- 過去の相談履歴保存
- 好みのツールや分野の学習

#### 2.2.2 フォローアップ機能
- 提案したツールの使用後フィードバック収集
- 追加の質問への対応
- 代替ツールの提案

#### 2.2.3 定期的な情報更新
- 新しいAIツールの情報収集
- 既存ツールの更新情報反映
- トレンド情報の提供

## 3. 非機能要件

### 3.1 パフォーマンス
- DMへの返信時間: 10秒以内
- 同時処理可能ユーザー数: 50人以上

### 3.2 可用性
- 稼働率: 99%以上
- 自動復旧機能の実装

### 3.3 セキュリティ
- ユーザーデータの暗号化
- Discord認証の適切な実装
- APIキーの安全な管理

### 3.4 ユーザビリティ
- AI初心者でも理解しやすい説明
- 専門用語を避けた平易な言葉遣い
- 視覚的に分かりやすいフォーマット

## 4. システム構成

### 4.1 n8nワークフロー構成

#### ワークフロー1: メイン処理フロー
1. **Discord Trigger Node**: DM受信をトリガー
2. **Function Node**: メッセージ内容の前処理
3. **AI Node (OpenAI/Claude)**: 作業内容の解析
4. **HTTP Request Node**: AIツール情報の検索
5. **AI Node**: 使用方法の生成
6. **Discord Node**: 返信の送信

#### ワークフロー2: データ管理フロー
1. **Database Node**: ユーザー情報の保存/取得
2. **Function Node**: 履歴データの整形
3. **Schedule Trigger**: 定期的なデータクリーンアップ

#### ワークフロー3: 管理者向けフロー
1. **Webhook Trigger**: 管理コマンドの受信
2. **Function Node**: ツールデータベースの更新
3. **Email Node**: エラー通知の送信

### 4.2 データフロー
```
Discord DM → n8n Webhook → AI解析 → ツール検索 → 
使用方法生成 → Discord返信 → ユーザー履歴保存
```

## 5. ユーザーストーリー

### 5.1 基本的な使用フロー
1. ユーザーがDiscord Butlerに「ブログ記事を書きたい」とDMを送信
2. Butlerが「どのような内容のブログ記事ですか？」と質問
3. ユーザーが「旅行記事」と返答
4. Butlerが以下を提案：
   - 推奨ツール: Claude, ChatGPT, Jasper AI
   - 各ツールの特徴と料金
   - 旅行記事作成の具体的手順
   - サンプルプロンプト

### 5.2 フォローアップフロー
1. ユーザーが「Claudeを使ってみたが上手くいかない」と相談
2. Butlerが問題点を確認
3. 改善されたプロンプトや使い方のコツを提案
4. 必要に応じて代替ツールを紹介

## 6. 開発フェーズ

### Phase 1: MVP開発（2週間）
- 基本的なDM受信・返信機能
- シンプルなAIツール提案機能
- 固定的なツールデータベース

### Phase 2: 機能拡張（3週間）
- ユーザープロファイル機能
- 動的なツール検索機能
- 詳細な使用方法生成

### Phase 3: 最適化（2週間）
- パフォーマンス改善
- エラーハンドリング強化
- 管理機能の実装

## 7. 成功指標

### 7.1 定量的指標
- 日次アクティブユーザー数: 100人以上
- 平均応答時間: 5秒以内
- ユーザー満足度: 80%以上

### 7.2 定性的指標
- AI初心者からの「分かりやすい」という評価
- 提案したツールの実際の採用率
- リピート利用率の向上

## 8. リスクと対策

### 8.1 技術的リスク
- **リスク**: API制限によるサービス停止
- **対策**: レート制限の実装、複数APIの併用

### 8.2 運用リスク
- **リスク**: 不適切なツール提案
- **対策**: フィードバックループの実装、定期的な精度確認

### 8.3 セキュリティリスク
- **リスク**: ユーザーデータの漏洩
- **対策**: 最小限のデータ保存、定期的な削除

## 9. 今後の拡張可能性

### 9.1 機能拡張
- Slack、Teams等の他プラットフォーム対応
- AIツールの自動実行機能
- コミュニティ機能（ユーザー間の情報共有）

### 9.2 ビジネス展開
- 有料プレミアムプラン
- 企業向けカスタマイズ版
- AIツールベンダーとの提携

## 10. n8n実装の詳細仕様

### 10.1 必要なノード
- Discord Trigger/Node
- OpenAI/Claude Node
- Function Node (JavaScript)
- Database Node (PostgreSQL/SQLite)
- HTTP Request Node
- Set Node
- IF Node

### 10.2 環境変数
```
DISCORD_BOT_TOKEN
OPENAI_API_KEY
CLAUDE_API_KEY
DATABASE_URL
WEBHOOK_SECRET
```

### 10.3 エクスポート形式
最終的な実装は、n8nのJSONエクスポート形式で提供し、ユーザーが直接インポートして使用できるようにする。